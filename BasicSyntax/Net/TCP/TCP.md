# TCP连接

## Server
* 一个TCP服务端可以同时连接很多个客户端，例如世界各地的用户使用自己电脑上的浏览器访问淘宝网。因为Go语言中创建多个goroutine实现并发非常方便和高效，所以我们可以每建立一次链接就创建一个goroutine去处理。
* TCP服务端程序的处理流程：
  * 监听端口
  * 接收客户端请求建立链接
  * 创建goroutine处理链接。


## Client
* 一个TCP客户端进行TCP通信的流程如下：
  * 建立与服务端的链接
  * 进行数据收发
  * 关闭链接

## 粘包(Sticky Package)
* 为什么会出现粘包
  * 由Nagle算法造成的发送端的粘包：Nagle算法是一种改善网络传输效率的算法。简单来说就是当我们提交一段数据给TCP发送时，TCP并不立刻发送此段数据，而是等待一小段时间看看在等待期间是否还有要发送的数据，若有则会一次把这两段数据发送出去。
  * 接收端接收不及时造成的接收端粘包：TCP会把接收到的数据存在自己的缓冲区中，然后通知应用层取数据。当应用层由于某些原因不能及时的把TCP的数据取出来，就会造成TCP缓冲区中存放了几段数据。
* 解决方法 ： 由于tcp字节流本身时无状态的，因此我们需要自定义协议，见proto包